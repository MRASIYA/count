<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body {
        font-family: 'Segoe UI', sans-serif;
        background: linear-gradient(135deg, #dbe9f4, #ffffff);
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
      }
      .card {
        background: #f5f9ff;
        padding: 30px;
        border-radius: 20px;
        box-shadow: 0 12px 24px rgba(0,0,0,0.1);
        width: 350px;
        text-align: center;
      }
      select, input {
        width: 100%;
        padding: 10px;
        margin: 10px 0;
        border: none;
        border-radius: 10px;
        box-shadow: inset 2px 2px 5px rgba(0,0,0,0.1);
        font-size: 16px;
      }
      button {
        background: #4a90e2;
        color: white;
        padding: 10px 20px;
        border: none;
        border-radius: 10px;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
      }
      button:hover {
        background: #357ab7;
      }
      #msg {
        margin-top: 10px;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <iframe src="https://script.google.com/macros/s/AKfycbyedVH_5YHbtJT_eD1paTKF1IYt1xhlchkq-IW3qh0VSHo3axitJBJiwIHy-s1rbAHO/exec"
        width="100%" height="600" style="border:none;"></iframe>

    <div class="card">
      <h2>Update Inventory</h2>
      <select id="itemSelect"></select>
      <input type="number" id="quantity" placeholder="Enter quantity to add">
      <button onclick="submitUpdate()">Update</button>
      <div id="msg"></div>
    </div>

    <script>
      function loadItems() {
        google.script.run.withSuccessHandler(function(items) {
          const select = document.getElementById('itemSelect');
          items.forEach(item => {
            const option = document.createElement('option');
            option.value = item;
            option.textContent = item;
            select.appendChild(option);
          });
        }).getItems();
      }

      function submitUpdate() {
        const item = document.getElementById('itemSelect').value;
        const quantity = document.getElementById('quantity').value;
        if (!quantity || isNaN(quantity)) {
          document.getElementById('msg').innerText = "Please enter a valid quantity.";
          return;
        }
        google.script.run.withSuccessHandler(function(msg) {
          document.getElementById('msg').innerText = msg;
        }).updateItem(item, quantity);
      }

      document.addEventListener('DOMContentLoaded', loadItems);
    </script>
  </body>
</html>
