<!-- Index.html -->

<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body { font-family: Arial; padding: 20px; }
      select, input, button { margin-top: 10px; padding: 8px; width: 100%; }
    </style>
  </head>
  <body>
    <h2>Issue Material</h2>

    <label>Select Item</label>
    <select id="itemDropdown"></select>

    <label>Enter Quantity</label>
    <input type="number" id="quantityInput" />

    <button onclick="submitForm()">Submit</button>

    <p id="message"></p>

    <script>
      function fetchItems() {
        google.script.run.withSuccessHandler(function(items) {
          const dropdown = document.getElementById("itemDropdown");
          dropdown.innerHTML = items.map(item => `<option value="${item}">${item}</option>`).join('');
        }).getItems();
      }

      function submitForm() {
        const item = document.getElementById("itemDropdown").value;
        const qty = document.getElementById("quantityInput").value;
        google.script.run.withSuccessHandler(function(response) {
          document.getElementById("message").innerText = response;
        }).submitData(item, qty);
      }

      fetchItems();
    </script>
  </body>
  <iframe src="https://docs.google.com/spreadsheets/d/1EP0HuQ_XzhLPCnMjUwiRxQo2m5AM7tYUTyKRUHAYLzE/edit?gid=0#gid=0" width="100%" height="400px"></iframe>

</html>
